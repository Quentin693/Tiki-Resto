"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2652],{98867:(e,t,r)=>{r.d(t,{A:()=>o});let o=(0,r(67401).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},60872:(e,t,r)=>{r.d(t,{A:()=>o});let o=(0,r(67401).A)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]])},33473:(e,t,r)=>{r.d(t,{A:()=>o});let o=(0,r(67401).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},45686:(e,t,r)=>{r.d(t,{A:()=>o});let o=(0,r(67401).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},40767:(e,t,r)=>{r.d(t,{A:()=>o});let o=(0,r(67401).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},17146:(e,t,r)=>{r.d(t,{AuthProvider:()=>i,h:()=>c});var o=r(95155),n=r(12115);let a=(0,n.createContext)(void 0);function c(){let e=(0,n.useContext)(a);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function i(e){let{children:t}=e,[r,c]=(0,n.useState)(null),[i,l]=(0,n.useState)(null),[s,u]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(()=>{try{let e=localStorage.getItem("user"),t=localStorage.getItem("token");e&&t&&(c(JSON.parse(e)),l(t))}catch(e){console.error("Error loading auth state from localStorage:",e)}finally{u(!1)}})()},[]);let h=async(e,t)=>{u(!0);try{console.log("Tentative de connexion pour ".concat(e));let r=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),o=await r.json();if(console.log("R\xe9ponse de l'API login:",r.status,o),!r.ok)throw Error(o.message||"Erreur lors de la connexion");if(!o.user||!o.token)throw console.error("Donn\xe9es de connexion incompl\xe8tes:",o),Error("Donn\xe9es de connexion incompl\xe8tes");return o.user.role||(console.warn('R\xf4le utilisateur non d\xe9fini, d\xe9finition par d\xe9faut \xe0 "user"'),o.user.role="user"),console.log("Utilisateur authentifi\xe9 avec r\xf4le:",o.user.role),localStorage.setItem("user",JSON.stringify(o.user)),localStorage.setItem("token",o.token),c(o.user),l(o.token),console.log("Connexion r\xe9ussie pour:",o.user.email),!0}catch(e){return console.error("Erreur de connexion:",e),!1}finally{u(!1)}},d=async(e,t,r,o)=>{u(!0);try{console.log("Tentative d'inscription pour ".concat(t));let n=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,password:r,phoneNumber:o})}),a=await n.json();if(console.log("R\xe9ponse de l'API inscription:",n.status,a),!n.ok)throw Error(a.message||"Erreur lors de l'inscription");if(!a.user||!a.token)throw console.error("Donn\xe9es d'inscription incompl\xe8tes:",a),Error("Donn\xe9es d'inscription incompl\xe8tes");return a.user.role||(console.warn('R\xf4le utilisateur non d\xe9fini, d\xe9finition par d\xe9faut \xe0 "user"'),a.user.role="user"),console.log("Nouvel utilisateur inscrit avec r\xf4le:",a.user.role),localStorage.setItem("user",JSON.stringify(a.user)),localStorage.setItem("token",a.token),c(a.user),l(a.token),console.log("Inscription r\xe9ussie pour:",a.user.email),!0}catch(e){return console.error("Erreur d'inscription:",e),!1}finally{u(!1)}},f=async()=>{if(!i)return!1;try{return(await fetch("/api/auth/check",{method:"GET",headers:{Authorization:"Bearer ".concat(i)}})).ok}catch(e){return console.error("Erreur lors de la v\xe9rification du token:",e),!1}},p=async()=>{if(!r||!r.email)return!1;try{let e=await fetch("/api/auth/user?email=".concat(encodeURIComponent(r.email)),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)return!1;let t=await e.json();return localStorage.setItem("user",JSON.stringify(t.user)),localStorage.setItem("token",t.token),c(t.user),l(t.token),!0}catch(e){return console.error("Erreur lors du rafra\xeechissement de la connexion:",e),!1}};return(0,o.jsx)(a.Provider,{value:{user:r,token:i,isLoading:s,isAuthenticated:!!r,login:h,register:d,logout:()=>{localStorage.removeItem("user"),localStorage.removeItem("token"),c(null),l(null),console.log("D\xe9connexion effectu\xe9e")},checkToken:f,refreshLogin:p},children:t})}},42649:(e,t,r)=>{r.d(t,{jE:()=>a,nz:()=>c,qE:()=>n});let o="https://api.votredomaine.com",n={getAll:async()=>{let e=await fetch("".concat(o,"/events"));if(!e.ok)throw Error("Failed to fetch events");return e.json()},getByType:async e=>{let t=await fetch("".concat(o,"/events/type/").concat(e));if(!t.ok)throw Error("Failed to fetch events of type ".concat(e));return t.json()},getById:async e=>{let t=await fetch("".concat(o,"/events/").concat(e));if(!t.ok)throw Error("Failed to fetch event with id ".concat(e));return t.json()},create:async e=>{let t=await fetch("".concat(o,"/events"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to create event");return t.json()},update:async(e,t)=>{let r=await fetch("".concat(o,"/events/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("token"))},body:JSON.stringify(t)});if(!r.ok)throw Error("Failed to update event");return r.json()},delete:async e=>{if(!(await fetch("".concat(o,"/events/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}})).ok)throw Error("Failed to delete event")}},a={async getAll(){let e=await fetch("".concat(o,"/gallery"));if(!e.ok)throw Error("Erreur lors de la r\xe9cup\xe9ration des images");return e.json()},async getCategories(){let e=await fetch("".concat(o,"/gallery/categories"));if(!e.ok)throw Error("Erreur lors de la r\xe9cup\xe9ration des cat\xe9gories");return e.json()},async getByCategory(e){let t=await fetch("".concat(o,"/gallery/category/").concat(e));if(!t.ok)throw Error("Erreur lors de la r\xe9cup\xe9ration des images de la cat\xe9gorie ".concat(e));return t.json()},async getById(e){let t=await fetch("".concat(o,"/gallery/").concat(e));if(!t.ok)throw Error("Erreur lors de la r\xe9cup\xe9ration de l'image avec l'ID ".concat(e));return t.json()},async create(e){let t=localStorage.getItem("token");if(!t)throw Error("Authentification requise");let r=await fetch("".concat(o,"/gallery"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)});if(!r.ok)throw Error("Erreur lors de la cr\xe9ation de l'image");return r.json()},async update(e,t){let r=localStorage.getItem("token");if(!r)throw Error("Authentification requise");let n=await fetch("".concat(o,"/gallery/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify(t)});if(!n.ok)throw Error("Erreur lors de la mise \xe0 jour de l'image avec l'ID ".concat(e));return n.json()},async delete(e){let t=localStorage.getItem("token");if(!t)throw Error("Authentification requise");if(!(await fetch("".concat(o,"/gallery/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok)throw Error("Erreur lors de la suppression de l'image avec l'ID ".concat(e))}},c={async getAll(){let e=await fetch("".concat(o,"/personnel"));if(!e.ok)throw Error("Erreur lors de la r\xe9cup\xe9ration du personnel");return e.json()},async getByService(e){let t=await fetch("".concat(o,"/personnel?service=").concat(e));if(!t.ok)throw Error("Erreur lors de la r\xe9cup\xe9ration du personnel du service ".concat(e));return t.json()},async getById(e){let t=await fetch("".concat(o,"/personnel/").concat(e));if(!t.ok)throw Error("Erreur lors de la r\xe9cup\xe9ration du membre du personnel avec l'ID ".concat(e));return t.json()},async create(e){let t=localStorage.getItem("token");if(!t)throw Error("Authentification requise");let r=await fetch("".concat(o,"/personnel"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)});if(!r.ok)throw Error("Erreur lors de la cr\xe9ation du membre du personnel");return r.json()},async update(e,t){let r=localStorage.getItem("token");if(!r)throw Error("Authentification requise");let n=await fetch("".concat(o,"/personnel/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify(t)});if(!n.ok)throw Error("Erreur lors de la mise \xe0 jour du membre du personnel avec l'ID ".concat(e));return n.json()},async delete(e){let t=localStorage.getItem("token");if(!t)throw Error("Authentification requise");if(!(await fetch("".concat(o,"/personnel/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok)throw Error("Erreur lors de la suppression du membre du personnel avec l'ID ".concat(e))}}}}]);