(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4520],{60669:(e,t,s)=>{Promise.resolve().then(s.bind(s,55337))},87364:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(67401).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},66462:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(67401).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},43831:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(67401).A)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},1466:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(67401).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},76046:(e,t,s)=>{"use strict";var r=s(66658);s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},55337:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>v});var r=s(95155),a=s(12115),o=s(5565),n=s(87364),l=s(66462),i=s(1466),c=s(43831),d=s(67401);let u=(0,d.A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),m=(0,d.A)("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),h=(0,d.A)("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var x=s(76046),p=s(17146),f=s(55037);function v(){let e=(0,x.useRouter)(),{user:t,login:s,register:d,isLoading:v}=(0,p.h)(),[b,g]=(0,a.useState)(!0),[w,j]=(0,a.useState)(!1),[N,y]=(0,a.useState)(!1),[A,C]=(0,a.useState)({name:"",email:"",password:"",confirmPassword:"",phoneNumber:""}),[k,B]=(0,a.useState)(""),[S,E]=(0,a.useState)("");(0,a.useEffect)(()=>{t&&e.push("/")},[t,e]);let R=async e=>{e.preventDefault(),E("");try{if(!b&&A.password!==A.confirmPassword){E("Les mots de passe ne correspondent pas"),f.oR.error("Les mots de passe ne correspondent pas");return}(b?await s(A.email,A.password):await d(A.name,A.email,A.password,A.phoneNumber))?f.oR.success(b?"Connexion r\xe9ussie!":"Inscription r\xe9ussie!"):(E(b?"Email ou mot de passe incorrect":"\xc9chec de l'inscription. Veuillez v\xe9rifier vos informations."),f.oR.error(b?"\xc9chec de la connexion":"\xc9chec de l'inscription"))}catch(e){E(e.message||"Une erreur est survenue"),f.oR.error(e.message||"Une erreur est survenue")}},I=e=>{let{name:t,value:s}=e.target;C(e=>({...e,[t]:s}))},P=async e=>{e.preventDefault(),f.oR.success("Instructions de r\xe9initialisation envoy\xe9es \xe0 ".concat(k)),y(!1)};return(0,r.jsxs)("div",{className:"flex flex-col min-h-screen bg-[#0f0f0f] text-white relative",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-black/40"}),(0,r.jsx)("main",{className:"flex-grow relative",children:(0,r.jsxs)("div",{className:"relative h-full",children:[(0,r.jsxs)("div",{className:"absolute inset-0 flex",children:[(0,r.jsxs)("div",{className:"w-[15%] sm:w-[20%] md:w-[25%] relative",children:[(0,r.jsx)(o.default,{src:"/decorations/leavesleft.webp",alt:"D\xe9coration gauche",fill:!0,className:"object-cover opacity-20",priority:!0}),(0,r.jsx)("div",{className:"absolute inset-y-0 right-0 w-1/3 bg-gradient-to-r from-transparent to-[#0f0f0f]"})]}),(0,r.jsx)("div",{className:"flex-grow bg-[#0f0f0f]",children:(0,r.jsx)("div",{className:"max-w-6xl mx-auto px-8"})}),(0,r.jsxs)("div",{className:"w-[15%] sm:w-[20%] md:w-[25%] relative",children:[(0,r.jsx)(o.default,{src:"/decorations/leavesright.webp",alt:"D\xe9coration droite",fill:!0,className:"object-cover opacity-20",priority:!0}),(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 w-1/3 bg-gradient-to-l from-transparent to-[#0f0f0f]"})]})]}),(0,r.jsx)("div",{className:"relative flex items-center justify-center min-h-screen py-12 px-4",children:(0,r.jsxs)("div",{className:"w-full mt-40 max-w-md",children:[(0,r.jsxs)("div",{className:"bg-[#2a2a2a]/90 backdrop-blur-md rounded-2xl shadow-xl border border-[#C4B5A2]/20 overflow-hidden",children:[(0,r.jsxs)("div",{className:"text-center p-8 bg-gradient-to-b from-[#C4B5A2] to-[#A69783]",children:[(0,r.jsx)("div",{className:"relative w-28 h-28 mx-auto mb-3",children:(0,r.jsx)(o.default,{src:"/logos/TikiLogo.png",alt:"Au Tiki Logo",fill:!0,className:"object-contain drop-shadow-md"})}),(0,r.jsx)("h1",{className:"text-3xl font-bold text-white font-didot tracking-wide drop-shadow-sm",children:N?"R\xe9cup\xe9ration":b?"Connexion":"Inscription"}),(0,r.jsx)("div",{className:"w-12 h-[2px] bg-white/50 mx-auto mt-2 mb-1"}),(0,r.jsx)("p",{className:"text-white/80 text-sm",children:N?"R\xe9cup\xe9rez l'acc\xe8s \xe0 votre compte":b?"Acc\xe9dez \xe0 votre espace personnel":"Rejoignez l'aventure Tiki d\xe8s maintenant"})]}),(0,r.jsx)("div",{className:"w-full h-1 bg-gradient-to-r from-transparent via-[#C4B5A2]/30 to-transparent"}),S&&(0,r.jsx)("div",{className:"mx-8 mt-4 p-3 bg-red-500/10 border border-red-500/30 rounded-lg",children:(0,r.jsx)("p",{className:"text-red-300 text-sm",children:S})}),(0,r.jsxs)("div",{className:"p-8",children:[N?(0,r.jsxs)("form",{onSubmit:P,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("button",{type:"button",onClick:()=>y(!1),className:"flex items-center text-[#C4B5A2] hover:text-white mb-6 transition-colors",children:[(0,r.jsx)(n.A,{className:"h-4 w-4 mr-1"}),(0,r.jsx)("span",{children:"Retour \xe0 la connexion"})]}),(0,r.jsx)("label",{className:"block text-sm font-medium text-white mb-2",children:"Email"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"email",value:k,onChange:e=>B(e.target.value),className:"w-full px-4 py-3 bg-[#1a1a1a] border border-[#C4B5A2]/30 rounded-lg focus:ring-2 focus:ring-[#C4B5A2] focus:border-transparent text-white pl-12",placeholder:"vous@example.com",required:!0}),(0,r.jsx)(l.A,{className:"absolute left-4 top-3.5 h-5 w-5 text-[#C4B5A2]"})]}),(0,r.jsx)("p",{className:"text-gray-400 text-xs mt-2",children:"Nous vous enverrons un lien pour r\xe9initialiser votre mot de passe."})]}),(0,r.jsx)("button",{type:"submit",className:"w-full bg-gradient-to-r from-[#C4B5A2] to-[#A69783] hover:from-[#A69783] hover:to-[#C4B5A2] text-white font-medium px-6 py-3 rounded-lg transition-all duration-300 shadow-md hover:shadow-lg transform hover:-translate-y-0.5",children:"Envoyer les instructions"})]}):(0,r.jsxs)("form",{onSubmit:R,className:"space-y-6",children:[!b&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-white mb-2",children:"Nom complet"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"text",name:"name",value:A.name,onChange:I,className:"w-full px-4 py-3 bg-[#1a1a1a] border border-[#C4B5A2]/30 rounded-lg focus:ring-2 focus:ring-[#C4B5A2] focus:border-transparent text-white pl-12",placeholder:"John Doe",required:!0}),(0,r.jsx)(i.A,{className:"absolute left-4 top-3.5 h-5 w-5 text-[#C4B5A2]"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-white mb-2",children:"Num\xe9ro de t\xe9l\xe9phone"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"tel",name:"phoneNumber",value:A.phoneNumber,onChange:I,className:"w-full px-4 py-3 bg-[#1a1a1a] border border-[#C4B5A2]/30 rounded-lg focus:ring-2 focus:ring-[#C4B5A2] focus:border-transparent text-white pl-12",placeholder:"06 12 34 56 78",required:!0}),(0,r.jsx)(c.A,{className:"absolute left-4 top-3.5 h-5 w-5 text-[#C4B5A2]"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-white mb-2",children:"Email"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"email",name:"email",value:A.email,onChange:I,className:"w-full px-4 py-3 bg-[#1a1a1a] border border-[#C4B5A2]/30 rounded-lg focus:ring-2 focus:ring-[#C4B5A2] focus:border-transparent text-white pl-12",placeholder:"vous@example.com",required:!0}),(0,r.jsx)(l.A,{className:"absolute left-4 top-3.5 h-5 w-5 text-[#C4B5A2]"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-white",children:"Mot de passe"}),b&&(0,r.jsx)("button",{type:"button",onClick:()=>y(!0),className:"text-sm text-[#C4B5A2] hover:text-white transition-colors",children:"Mot de passe oubli\xe9 ?"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:w?"text":"password",name:"password",value:A.password,onChange:I,className:"w-full px-4 py-3 bg-[#1a1a1a] border border-[#C4B5A2]/30 rounded-lg focus:ring-2 focus:ring-[#C4B5A2] focus:border-transparent text-white pl-12",placeholder:"••••••••",required:!0}),(0,r.jsx)(u,{className:"absolute left-4 top-3.5 h-5 w-5 text-[#C4B5A2]"}),(0,r.jsx)("button",{type:"button",onClick:()=>j(!w),className:"absolute right-4 top-3.5 text-[#C4B5A2] hover:text-white transition-colors",children:w?(0,r.jsx)(m,{className:"h-5 w-5"}):(0,r.jsx)(h,{className:"h-5 w-5"})})]})]}),!b&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-white mb-2",children:"Confirmer le mot de passe"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:w?"text":"password",name:"confirmPassword",value:A.confirmPassword,onChange:I,className:"w-full px-4 py-3 bg-[#1a1a1a] border border-[#C4B5A2]/30 rounded-lg focus:ring-2 focus:ring-[#C4B5A2] focus:border-transparent text-white pl-12",placeholder:"••••••••",required:!0}),(0,r.jsx)(u,{className:"absolute left-4 top-3.5 h-5 w-5 text-[#C4B5A2]"})]})]}),(0,r.jsx)("button",{type:"submit",disabled:v,className:"w-full bg-gradient-to-r from-[#C4B5A2] to-[#A69783] hover:from-[#A69783] hover:to-[#C4B5A2] text-white font-medium px-6 py-3 rounded-lg transition-all duration-300 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none disabled:shadow-none",children:v?(0,r.jsxs)("div",{className:"flex items-center justify-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Chargement..."]}):b?"Se connecter":"S'inscrire"})]}),!N&&(0,r.jsxs)("div",{className:"mt-6 text-center",children:[(0,r.jsxs)("div",{className:"relative py-3",children:[(0,r.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,r.jsx)("div",{className:"w-full border-t border-[#C4B5A2]/20"})}),(0,r.jsx)("div",{className:"relative flex justify-center",children:(0,r.jsx)("span",{className:"px-4 bg-[#2a2a2a] text-gray-400 text-sm",children:"ou"})})]}),(0,r.jsxs)("p",{className:"text-gray-400 mt-4",children:[b?"Vous n'avez pas de compte ?":"Vous avez d\xe9j\xe0 un compte ?"," ",(0,r.jsx)("button",{onClick:()=>{g(!b),E("")},className:"text-[#C4B5A2] hover:text-white transition-colors font-medium",children:b?"S'inscrire":"Se connecter"})]})]})]})]}),(0,r.jsxs)("div",{className:"mt-6 text-center",children:[(0,r.jsxs)("div",{className:"flex justify-center opacity-80 space-x-1",children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full bg-[#C4B5A2]"}),(0,r.jsx)("div",{className:"w-2 h-2 rounded-full bg-[#C4B5A2]/50"}),(0,r.jsx)("div",{className:"w-2 h-2 rounded-full bg-[#C4B5A2]/30"})]}),(0,r.jsxs)("p",{className:"mt-4 text-gray-400 text-xs",children:["En vous connectant, vous acceptez les ",(0,r.jsx)("a",{href:"#",className:"underline hover:text-[#C4B5A2]",children:"Conditions d'utilisation"})," et la ",(0,r.jsx)("a",{href:"#",className:"underline hover:text-[#C4B5A2]",children:"Politique de confidentialit\xe9"})]})]})]})})]})})]})}},17146:(e,t,s)=>{"use strict";s.d(t,{AuthProvider:()=>l,h:()=>n});var r=s(95155),a=s(12115);let o=(0,a.createContext)(void 0);function n(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function l(e){let{children:t}=e,[s,n]=(0,a.useState)(null),[l,i]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(()=>{try{let e=localStorage.getItem("user"),t=localStorage.getItem("token");e&&t&&(n(JSON.parse(e)),i(t))}catch(e){console.error("Error loading auth state from localStorage:",e)}finally{d(!1)}})()},[]);let u=async(e,t)=>{d(!0);try{console.log("Tentative de connexion pour ".concat(e));let s=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),r=await s.json();if(console.log("R\xe9ponse de l'API login:",s.status,r),!s.ok)throw Error(r.message||"Erreur lors de la connexion");if(!r.user||!r.token)throw console.error("Donn\xe9es de connexion incompl\xe8tes:",r),Error("Donn\xe9es de connexion incompl\xe8tes");return r.user.role||(console.warn('R\xf4le utilisateur non d\xe9fini, d\xe9finition par d\xe9faut \xe0 "user"'),r.user.role="user"),console.log("Utilisateur authentifi\xe9 avec r\xf4le:",r.user.role),localStorage.setItem("user",JSON.stringify(r.user)),localStorage.setItem("token",r.token),n(r.user),i(r.token),console.log("Connexion r\xe9ussie pour:",r.user.email),!0}catch(e){return console.error("Erreur de connexion:",e),!1}finally{d(!1)}},m=async(e,t,s,r)=>{d(!0);try{console.log("Tentative d'inscription pour ".concat(t));let a=await fetch("/api/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:t,password:s,phoneNumber:r})}),o=await a.json();if(console.log("R\xe9ponse de l'API inscription:",a.status,o),!a.ok)throw Error(o.message||"Erreur lors de l'inscription");if(!o.user||!o.token)throw console.error("Donn\xe9es d'inscription incompl\xe8tes:",o),Error("Donn\xe9es d'inscription incompl\xe8tes");return o.user.role||(console.warn('R\xf4le utilisateur non d\xe9fini, d\xe9finition par d\xe9faut \xe0 "user"'),o.user.role="user"),console.log("Nouvel utilisateur inscrit avec r\xf4le:",o.user.role),localStorage.setItem("user",JSON.stringify(o.user)),localStorage.setItem("token",o.token),n(o.user),i(o.token),console.log("Inscription r\xe9ussie pour:",o.user.email),!0}catch(e){return console.error("Erreur d'inscription:",e),!1}finally{d(!1)}},h=async()=>{if(!l)return!1;try{return(await fetch("/api/auth/check",{method:"GET",headers:{Authorization:"Bearer ".concat(l)}})).ok}catch(e){return console.error("Erreur lors de la v\xe9rification du token:",e),!1}},x=async()=>{if(!s||!s.email)return!1;try{let e=await fetch("/api/auth/user?email=".concat(encodeURIComponent(s.email)),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)return!1;let t=await e.json();return localStorage.setItem("user",JSON.stringify(t.user)),localStorage.setItem("token",t.token),n(t.user),i(t.token),!0}catch(e){return console.error("Erreur lors du rafra\xeechissement de la connexion:",e),!1}};return(0,r.jsx)(o.Provider,{value:{user:s,token:l,isLoading:c,isAuthenticated:!!s,login:u,register:m,logout:()=>{localStorage.removeItem("user"),localStorage.removeItem("token"),n(null),i(null),console.log("D\xe9connexion effectu\xe9e")},checkToken:h,refreshLogin:x},children:t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[5565,4069,8441,1517,7358],()=>t(60669)),_N_E=e.O()}]);