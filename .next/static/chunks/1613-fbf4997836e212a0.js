"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1613],{71613:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(46367),o=n(2818);let c={initEmailJS:()=>{a.Ay.init(o.env.EMAILJS_PUBLIC_KEY||"gqW9Mpq_cBBEtVQH_")},sendSMS:async(e,t)=>{try{let n=await fetch("/api/send-sms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to:e,message:t})});if(!n.ok)throw Error("Failed to send SMS");return(await n.json()).success}catch(e){return console.error("Error sending SMS:",e),!1}},sendEmail:async(e,t)=>{try{let n=o.env.EMAILJS_SERVICE_ID||"service_u9tg3i7",c=await a.Ay.send(n,e,t);return 200===c.status}catch(e){return console.error("Error sending email:",e),!1}},getNotificationContent:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"confirmation",n=arguments.length>2?arguments[2]:void 0,a="",o={...n},c="Restaurant Tiki Au bord de l'eau";switch(e){case"reservation":let i=new Date(n.date),r=i.toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}),s=i.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"});switch(t){case"confirmation":a="Bonjour ".concat(n.customerName,", votre r\xe9servation au ").concat(c," est confirm\xe9e pour le ").concat(r," \xe0 ").concat(s," pour ").concat(n.numberOfGuests," personne(s). Pour toute modification, veuillez nous contacter au 04 78 49 02 39. \xc0 bient\xf4t !"),o.subject="Confirmation de votre r\xe9servation - ".concat(c);break;case"modification":a="Bonjour ".concat(n.customerName,", votre r\xe9servation au ").concat(c," a \xe9t\xe9 modifi\xe9e avec succ\xe8s. Nouvelle date: ").concat(r," \xe0 ").concat(s," pour ").concat(n.numberOfGuests," personne(s). Pour toute question, veuillez nous contacter au 04 78 49 02 39."),o.subject="Modification de votre r\xe9servation - ".concat(c);break;case"cancellation":a="Bonjour ".concat(n.customerName,", votre r\xe9servation au ").concat(c," pour le ").concat(r," \xe0 ").concat(s," a \xe9t\xe9 annul\xe9e. Nous esp\xe9rons vous revoir bient\xf4t !"),o.subject="Annulation de votre r\xe9servation - ".concat(c)}o.message=a;break;case"event":let u=new Date(n.eventDate||n.date).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"});switch(o.customerName=n.customerName,o.customerEmail=n.customerEmail||n.email,o.customerPhone=n.customerPhone||n.phone,o.eventType=n.eventType,o.formattedEventDate=u,o.guestCount=n.guestCount||n.numberOfGuests,o.specialRequests=n.specialRequests||"Aucune demande sp\xe9ciale",o.details="\n            Type d'\xe9v\xe9nement: ".concat(n.eventType,"\n            Date: ").concat(u,"\n            Nombre d'invit\xe9s: ").concat(n.guestCount||n.numberOfGuests,"\n            Demandes sp\xe9ciales: ").concat(n.specialRequests||"Aucune","\n        "),t){case"confirmation":a="Bonjour ".concat(n.customerName,", votre demande d'\xe9v\xe9nement au ").concat(c," pour le ").concat(u," a \xe9t\xe9 confirm\xe9e. Un membre de notre \xe9quipe vous contactera pour finaliser les d\xe9tails."),o.subject="Confirmation de votre \xe9v\xe9nement - ".concat(c);break;case"modification":a="Bonjour ".concat(n.customerName,", les d\xe9tails de votre \xe9v\xe9nement au ").concat(c," ont \xe9t\xe9 modifi\xe9s. Un r\xe9capitulatif vous a \xe9t\xe9 envoy\xe9 par email."),o.subject="Modification de votre \xe9v\xe9nement - ".concat(c);break;case"cancellation":a="Bonjour ".concat(n.customerName,", votre \xe9v\xe9nement au ").concat(c," pr\xe9vu le ").concat(u," a \xe9t\xe9 annul\xe9. Pour toute question, veuillez nous contacter."),o.subject="Annulation de votre \xe9v\xe9nement - ".concat(c)}o.message=a;break;case"seafood":var m,l,p;let d=[];n.plateaux&&Array.isArray(n.plateaux)&&n.plateaux.length>0?d=n.plateaux.map(e=>"".concat(e.name," x").concat(e.quantity,": ").concat(e.price*e.quantity,"€")):n.plateauxStr?d.push(n.plateauxStr):n.plateaux&&d.push(n.plateaux);let v=[];n.items&&Array.isArray(n.items)&&n.items.length>0?v=n.items.map(e=>{let t=e.name||"";return e.half&&(t+=" (demi-douzaine)"),"".concat(t," x").concat(e.quantity,": ").concat((e.price*e.quantity).toFixed(2),"€")}):n.itemsStr?v=n.itemsStr.split(", ").map(e=>e.trim()).filter(e=>"Aucun"!==e):n.items&&v.push(n.items);let f=n.totalPrice||n.totalAmount||0;"number"==typeof f&&(f=f.toFixed(2));let N="\n".concat(d.length>0?"PLATEAUX:\n"+d.map(e=>"- ".concat(e)).join("\n")+"\n\n":"","\n").concat(v.length>0?"PRODUITS INDIVIDUELS:\n"+v.map(e=>"- ".concat(e)).join("\n")+"\n\n":"","\n").concat(n.specialRequests?"DEMANDES SP\xc9CIALES:\n".concat(n.specialRequests,"\n\n"):"","\nMONTANT TOTAL: ").concat(f,"€\nMode: ").concat(!1===n.isPickup?"Sur place":"\xc0 emporter","\n        ").trim();console.log("D\xe9tails de la commande pour EmailJS:",N);let h=n.customerName||(null===(m=n.customer)||void 0===m?void 0:m.name)||n.name||"Client";switch(t){case"confirmation":a="Bonjour ".concat(h,", votre commande de fruits de mer au ").concat(c," est confirm\xe9e. \xc0 r\xe9cup\xe9rer le ").concat(n.pickupDate," \xe0 ").concat(n.pickupTime,". Montant total: ").concat(f,"€."),o.subject="Confirmation de votre commande de fruits de mer - ".concat(c);break;case"modification":a="Bonjour ".concat(h,", votre commande de fruits de mer au ").concat(c," a \xe9t\xe9 modifi\xe9e. Nouvelle date de retrait: ").concat(n.pickupDate," \xe0 ").concat(n.pickupTime,". Un email r\xe9capitulatif vous a \xe9t\xe9 envoy\xe9."),o.subject="Modification de votre commande de fruits de mer - ".concat(c);break;case"cancellation":a="Bonjour ".concat(h,", votre commande de fruits de mer au ").concat(c," a \xe9t\xe9 annul\xe9e. Pour toute question, veuillez nous contacter au 04 78 49 02 39."),o.subject="Annulation de votre commande de fruits de mer - ".concat(c)}console.log("Donn\xe9es envoy\xe9es:",JSON.stringify(n,null,2)),o={customerName:h,customerEmail:n.customerEmail||(null===(l=n.customer)||void 0===l?void 0:l.email)||n.email||"Non fourni",customerPhone:n.customerPhone||(null===(p=n.customer)||void 0===p?void 0:p.phone)||n.phone||"Non fourni",orderTime:"".concat(n.pickupDate||"Date non sp\xe9cifi\xe9e"," \xe0 ").concat(n.pickupTime||"Heure non sp\xe9cifi\xe9e"),details:N,message:a,subject:o.subject,plateaux:JSON.stringify(n.plateaux||[]),items:JSON.stringify(n.items||[]),totalPrice:f};break;case"contact":a="",o={message:n.message,customerName:n.name||n.customerName,customerEmail:n.email||n.customerEmail,customerPhone:n.phone||n.customerPhone||"Non fourni"}}return{smsBody:a,emailParams:o}},notifyAdmin:async(e,t)=>{c.initEmailJS();let n=o.env.EMAILJS_ADMIN_TEMPLATE_ID||"template_7hdjtxp",a=o.env.ADMIN_EMAIL||"sanchit.jain3107@gmail.com",i=t.name||t.customerName||"Client",r={},s="";if("seafood"===e){var u,m,l,p,d,v,f;let e=[];t.plateaux&&Array.isArray(t.plateaux)&&t.plateaux.length>0?e=t.plateaux.map(e=>"".concat(e.name," x").concat(e.quantity,": ").concat(e.price*e.quantity,"€")):t.plateauxStr?e.push(t.plateauxStr):t.plateaux&&e.push(t.plateaux);let n=[];t.items&&Array.isArray(t.items)&&t.items.length>0?n=t.items.map(e=>{let t=e.name||"";return e.half&&(t+=" (demi-douzaine)"),"".concat(t," x").concat(e.quantity,": ").concat((e.price*e.quantity).toFixed(2),"€")}):t.itemsStr?n=t.itemsStr.split(", ").map(e=>e.trim()).filter(e=>"Aucun"!==e):t.items&&n.push(t.items);let o=t.totalPrice||t.totalAmount||0;"number"==typeof o&&(o=o.toFixed(2));let c="\nNOUVELLE COMMANDE DE FRUITS DE MER\n\nCLIENT:\nNom: ".concat(t.customerName||(null===(u=t.customer)||void 0===u?void 0:u.name)||t.name||"Non fourni","\nEmail: ").concat(t.customerEmail||(null===(m=t.customer)||void 0===m?void 0:m.email)||t.email||"Non fourni","\nT\xe9l\xe9phone: ").concat(t.customerPhone||(null===(l=t.customer)||void 0===l?void 0:l.phone)||t.phone||"Non fourni","\n\nINFORMATIONS DE RETRAIT:\nDate: ").concat(t.pickupDate||"Non sp\xe9cifi\xe9e","\nHeure: ").concat(t.pickupTime||"Non sp\xe9cifi\xe9e","\nMode: ").concat(!1===t.isPickup?"Sur place":"\xc0 emporter","\n\n").concat(e.length>0?"PLATEAUX:\n"+e.map(e=>"- ".concat(e)).join("\n")+"\n\n":"","\n").concat(n.length>0?"PRODUITS INDIVIDUELS:\n"+n.map(e=>"- ".concat(e)).join("\n")+"\n\n":"","\n\n").concat(t.specialRequests?"DEMANDES SP\xc9CIALES:\n".concat(t.specialRequests,"\n\n"):"","\n\nMONTANT TOTAL: ").concat(o,"€\n      ").trim();s="Nouvelle commande de fruits de mer",r={from_name:i,to_name:"Admin",from_email:t.email||(null===(p=t.customer)||void 0===p?void 0:p.email)||"client@example.com",to_email:a,subject:s,customerName:t.customerName||(null===(d=t.customer)||void 0===d?void 0:d.name)||t.name||"Client",customerEmail:t.customerEmail||(null===(v=t.customer)||void 0===v?void 0:v.email)||t.email||"Non fourni",customerPhone:t.customerPhone||(null===(f=t.customer)||void 0===f?void 0:f.phone)||t.phone||"Non fourni",orderTime:"".concat(t.pickupDate||"Date non sp\xe9cifi\xe9e"," \xe0 ").concat(t.pickupTime||"Heure non sp\xe9cifi\xe9e"),details:c,message:"Nouvelle commande de fruits de mer de ".concat(i," pour le ").concat(t.pickupDate||"Date non sp\xe9cifi\xe9e"," \xe0 ").concat(t.pickupTime||"Heure non sp\xe9cifi\xe9e",". Total: ").concat(o,"€")}}else if("event"===e){let e=(t.eventDate?new Date(t.eventDate):new Date).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}),n="\n        Type d'\xe9v\xe9nement: ".concat(t.eventType||"Non sp\xe9cifi\xe9","\n        Date: ").concat(e,"\n        Nombre d'invit\xe9s: ").concat(t.guestCount||t.numberOfGuests||"Non sp\xe9cifi\xe9","\n        Demandes sp\xe9ciales: ").concat(t.specialRequests||"Aucune","\n      ");s="Nouvelle demande d'\xe9v\xe9nement: ".concat(t.eventType||"\xc9v\xe9nement"),r={from_name:i,to_name:"Admin",from_email:t.email||t.customerEmail||"client@example.com",to_email:a,subject:s,message:"Nouvelle demande d'\xe9v\xe9nement de ".concat(i,"."),details:n,customerName:t.customerName||t.name||"Non fourni",customerEmail:t.customerEmail||t.email||"Non fourni",customerPhone:t.customerPhone||t.phone||"Non fourni",eventType:t.eventType||"Non sp\xe9cifi\xe9",formattedEventDate:e,guestCount:t.guestCount||t.numberOfGuests||"Non sp\xe9cifi\xe9",specialRequests:t.specialRequests||"Aucune"}}else if("contact"===e){let e="\n        Nom: ".concat(t.name||"Non fourni","\n        Email: ").concat(t.email||"Non fourni","\n        T\xe9l\xe9phone: ").concat(t.phone||"Non fourni","\n        Message: ").concat(t.message||"Aucun message","\n      ");s="Nouveau message du formulaire de contact",r={from_name:i,to_name:"Admin",from_email:t.email||"client@example.com",to_email:a,subject:s,message:e,details:e,name:t.name||"Non fourni",email:t.email||"Non fourni",phone:t.phone||"Non fourni"}}return await c.sendEmail(n,r)},notify:async e=>{let{type:t,action:n="confirmation",data:a,sendSMS:i=!0,sendEmail:r=!0}=e,s={sms:!1,email:!1};r&&c.initEmailJS();let{smsBody:u,emailParams:m}=c.getNotificationContent(t,n,a);if(i&&a.phone&&u&&(s.sms=await c.sendSMS(a.phone,u)),r){let e="";switch(t){case"contact":e="template_qjj36uy";break;case"event":e="template_w96gc7k";break;case"reservation":e=o.env.EMAILJS_RESERVATION_TEMPLATE_ID||"template_w96gc7k";break;case"seafood":e="template_xt2walv";break;default:e=o.env.EMAILJS_TEMPLATE_ID||"template_w96gc7k"}e&&(s.email=await c.sendEmail(e,m)),("seafood"===t||"event"===t||"contact"===t)&&await c.notifyAdmin(t,a)}return s}},i=c}}]);